# Network-Threat-Detection

## Objective

I am working as a Tier 1 Security Analyst for a Managed Security Service Provider (MSSP). Today I'm tasked with monitoring network alerts. The objective is to investigate and validate the network security alert indicating the detection of a network trojan and a potential corporate privacy violation. This involves analyzing the alert generated by an Intrusion Detection System (IDS) or Intrusion Prevention System (IPS) to understand the nature and context of the detected activity. The goal is to assess whether the alert indicates a legitimate security threat or if it is a benign event mistakenly flagged as malicious.

Project: Misc activity, A Network Trojan Was Detected, and Potential Corporate Privacy Violation. 

### Skills Learned

- Monitoring & Detection Skills.
- Proficiency in analyzing and interpreting network logs.
- Ability to generate and recognize attack signatures and patterns.
- Enhanced knowledge of network protocols and security vulnerabilities.
- Development of critical thinking and problem-solving skills in cybersecurity.

### Tools Used

- Brim.
- Network Miner.
- Wireshark.
- VirusTotal.

## Steps
Project: Misc activity, A Network Trojan Was Detected, and Potential Corporate Privacy Violation.

~ TASK 1: Find the Network Trojan Alert and the alert signature.

Open BRIM and scroll down on the left hand side in the Queries tab and double click on the “Suricata Alerts by Category” and then right click on "A Network Trojan was detected" and “New search with this value”.

![image](https://github.com/user-attachments/assets/aaa5bb8c-9154-44ea-8bf3-83f0aa6e3cfe)  ~All the alerts generated by Suricata.

![image](https://github.com/user-attachments/assets/a6b9ee82-a790-4f00-9cb1-3ae3f28c1f19)  ~When I view the log details, I can see both the alert signature and the source/destination IP address.

After investigating the "Potential Corporate Privacy Violation" log details, I noticed that the alerts are originating from the same IP address.

![image](https://github.com/user-attachments/assets/0c073caa-70fb-48e6-82cf-b45785ade3e8)  ~"Potential Corporate Privacy Violation" Log Details.

The IP address that triggered both alerts is 185.118.164.8 (defanged as 185[.]118[.]164[.]8 for safety). I used CyberChef to defang the IP address.

~TASK 2: Find the full URI for the malicious downloaded file and defang the URI. 

 To retrieve the full URI, I revisited the Network Trojan event and double-clicked it for more detailed information. From there, I accessed the related connections by clicking on "conn."
 
![image](https://github.com/user-attachments/assets/418db480-6b68-45a8-b8bf-b7545fbe6513) ~"A Network Trojan was detected" Log Details.

This led me to the related connections, where I found an HTTP request. Clicking on this request provided further details, including the host and URI sections.

![image](https://github.com/user-attachments/assets/9058cff1-5756-4393-9a47-e614801f859e)  ~Log Details of the related connections from the HTTP request.

The full URI for the malicious downloaded file, defanged using CyberChef: awh93dhkylps5ulnq-be[.]com/czwih/fxla[.]php?l=gap1[.]cab.
From here I can also see details of the user agent.


~TASK 3: Find the name of the payload within the cab file.

For this step, I opened the pcap file in NetworkMiner and then went to the Files tab. There I filtered for gap1.cab and double-clicked it to open the details and found the MD5 hash.

![image](https://github.com/user-attachments/assets/8aba031d-2ff9-4e1d-ada1-655c710c9d43) ~NetworkMiner, files tab.

![image](https://github.com/user-attachments/assets/7c3851f6-aa9e-4afc-9209-45846ee707db) ~NetworkMiner, MD5 hash value. 

Next I want to search for the hash in VirusTotal to get additional details on the malicious file and the payload.

![image](https://github.com/user-attachments/assets/00fabd9d-cc1b-4af4-8941-a0c4568e9c1a) ~VirusTotal

VirusTotal reveals that the malicious file is named "draw.dll", which identifies the payload.




